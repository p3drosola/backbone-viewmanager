(function(){var a={_view_bindings:[]};Backbone.ViewManager={};a.addSubview=function(a,b){var c,d;c=new a(_.extend(b,{viewManager:true}));d=this instanceof Backbone.View?this:null;$(c.el).bind("remove",c.closeView);Backbone.ViewManager.children_of[c.cid]=[];if(d!==null){Backbone.ViewManager.children_of[d.cid].push(c)}Backbone.ViewManager.parent_of[c.cid]=d;return c};a.closeView=function(){if(Backbone.ViewManager.parent_of[this.cid]===undefined)return;this.trigger("closeView");var a=this.subViews(),b=Backbone.ViewManager.parent_of[this.cid];delete Backbone.ViewManager.parent_of[this.cid];delete Backbone.ViewManager.children_of[this.cid];if(b){var c=Backbone.ViewManager.children_of[b.cid];var d=_(c).indexOf(this);if(d!==-1)c.splice(d,1)}_(a).each(function(a){a.closeView()});_(this._view_bindings).each(function(a){var b=a[3]?a[3][0]:"unbind";a[0]["unbind"](a[1],[a[2]])},this);this.unbind();this.remove()};a.subViews=function(){return Backbone.ViewManager.children_of[this.cid]};a.parentView=function(){return Backbone.ViewManager.parent_of[this.cid]};a.viewBind=function(a,b,c,d){var e=d?d[0]:"bind";this._view_bindings.push([a,b,c,d]);a[e](b,c)};Backbone.ViewManager.children_of={};Backbone.ViewManager.parent_of={};Backbone.ViewManager.create=a.addSubview;_.extend(Backbone.View.prototype,a)})()